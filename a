-- SpareStack UI Library - ENHANCED VERSION WITH IMPROVED CONFIG SYSTEM
-- Features124412

local SpareStackLib = {}
SpareStackLib.__index = SpareStackLib

local TweenService = game:GetService("TweenService")
local UIS = game:GetService("UserInputService")
local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")

-- Helper function for creating instances
function createInstance(className, properties)
    local instance = Instance.new(className)
    for k, v in pairs(properties) do
        if typeof(k) ~= 'string' then
            continue
        end
        instance[k] = v
    end
    return instance
end

function SpareStackLib:CreateWindow(title)
	local self = setmetatable({}, SpareStackLib)
	
	-- Main ScreenGui
	local Sparestack = Instance.new("ScreenGui")
	Sparestack.Name = "Spare stack"
	Sparestack.Parent = Players.LocalPlayer:WaitForChild("PlayerGui")
	Sparestack.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
	Sparestack.ResetOnSpawn = false
	Sparestack.IgnoreGuiInset = true
	
	-- Background
	local Background = Instance.new("ImageLabel")
	Background.Name = "Background"
	Background.Parent = Sparestack
	Background.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
	Background.BackgroundTransparency = 1.000
	Background.BorderSizePixel = 0
	Background.AnchorPoint = Vector2.new(0.5, 0.5)
	Background.Position = UDim2.new(0.5, 0, 0.5, 0)
	Background.Size = UDim2.new(0, 1011, 0, 630)
	Background.ZIndex = 0
	Background.Image = "rbxassetid://71105506054247"
	Background.ScaleType = Enum.ScaleType.Stretch
	
	-- Make draggable
	local dragging = false
	local dragInput, mousePos, framePos
	local isDraggingSlider = false
	
	Background.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 and not isDraggingSlider then
			dragging = true
			mousePos = input.Position
			framePos = Background.Position
			
			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then
					dragging = false
				end
			end)
		end
	end)
	
	Background.InputChanged:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseMovement then
			dragInput = input
		end
	end)
	
	UIS.InputChanged:Connect(function(input)
		if input == dragInput and dragging and not isDraggingSlider then
			local delta = input.Position - mousePos
			Background.Position = UDim2.new(
				framePos.X.Scale,
				framePos.X.Offset + delta.X,
				framePos.Y.Scale,
				framePos.Y.Offset + delta.Y
			)
		end
	end)
	
	local UIPadding = Instance.new("UIPadding")
	UIPadding.Parent = Background
	UIPadding.PaddingLeft = UDim.new(0, 10)
	
	-- Search Holder
	local SearchHolder = Instance.new("Frame")
	SearchHolder.Name = "SearchHolder"
	SearchHolder.Parent = Background
	SearchHolder.BackgroundTransparency = 1
	SearchHolder.Position = UDim2.new(0.252, 0, 0.019, 0)
	SearchHolder.Size = UDim2.new(0, 198, 0, 40)
	
	local Search = Instance.new("TextBox")
	Search.Name = "Search"
	Search.Parent = SearchHolder
	Search.BackgroundColor3 = Color3.fromRGB(20, 20, 27)
	Search.BorderSizePixel = 0
	Search.Size = UDim2.new(1, 0, 1, 0)
	Search.Font = Enum.Font.GothamSemibold
	Search.PlaceholderText = "Search . . ."
	Search.Text = ""
	Search.TextColor3 = Color3.fromRGB(255, 255, 255)
	Search.TextSize = 14
	Search.TextXAlignment = Enum.TextXAlignment.Left
	Search.ClearTextOnFocus = false
	
	local SearchPadding = Instance.new("UIPadding")
	SearchPadding.Parent = Search
	SearchPadding.PaddingLeft = UDim.new(0, 15)
	
	local SearchCorner = Instance.new("UICorner")
	SearchCorner.CornerRadius = UDim.new(0, 3)
	SearchCorner.Parent = Search
	
	local SearchIcon = Instance.new("ImageLabel")
	SearchIcon.Parent = Search
	SearchIcon.BackgroundTransparency = 1
	SearchIcon.Position = UDim2.new(0.805, 0, 0.3, 0)
	SearchIcon.Size = UDim2.new(0, 15, 0, 15)
	SearchIcon.Image = "rbxassetid://105544331892424"
	
	-- Settings Button
	local Settings = Instance.new("TextButton")
	Settings.Name = "Settings"
	Settings.Parent = Background
	Settings.BackgroundColor3 = Color3.fromRGB(20, 20, 27)
	Settings.BorderSizePixel = 0
	Settings.Position = UDim2.new(0.93, 0, 0.017, 0)
	Settings.Size = UDim2.new(0, 45, 0, 45)
	Settings.Text = ""
	Settings.ZIndex = 2
	
	local SettingsCorner = Instance.new("UICorner")
	SettingsCorner.CornerRadius = UDim.new(0, 3)
	SettingsCorner.Parent = Settings
	
	local SettingsImage = Instance.new("ImageLabel")
	SettingsImage.Parent = Settings
	SettingsImage.BackgroundTransparency = 1
	SettingsImage.Position = UDim2.new(0.256, 0, 0.284, 0)
	SettingsImage.Size = UDim2.new(0, 20, 0, 20)
	SettingsImage.Image = "rbxassetid://70543102142774"
	SettingsImage.ZIndex = 3
	
	-- Title Image
	local TitleImage = Instance.new("ImageLabel")
	TitleImage.Name = "Title"
	TitleImage.Parent = Background
	TitleImage.BackgroundTransparency = 1
	TitleImage.Position = UDim2.new(0.01, 0, 0.019, 0)
	TitleImage.Size = UDim2.new(0, 200, 0, 40)
	TitleImage.Image = "rbxassetid://117733299243150"
	
	-- Side Holder
	local SideHolder = Instance.new("ScrollingFrame")
	SideHolder.Name = "SideHolder"
	SideHolder.Parent = Background
	SideHolder.BackgroundTransparency = 1
	SideHolder.BorderSizePixel = 0
	SideHolder.Position = UDim2.new(0.01, 0, 0.12, 0)
	SideHolder.Size = UDim2.new(0, 200, 0, 520)
	SideHolder.ScrollBarThickness = 0
	SideHolder.CanvasSize = UDim2.new(0, 0, 0, 0)
	
	local SideLayout = Instance.new("UIListLayout")
	SideLayout.Parent = SideHolder
	SideLayout.SortOrder = Enum.SortOrder.LayoutOrder
	SideLayout.Padding = UDim.new(0, 5)
	
	SideLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
		SideHolder.CanvasSize = UDim2.new(0, 0, 0, SideLayout.AbsoluteContentSize.Y + 10)
	end)
	
	-- Card Holder - CENTERED CARDS
	local CardHolder = Instance.new("ScrollingFrame")
	CardHolder.Name = "CardHolder"
	CardHolder.Parent = Background
	CardHolder.Active = true
	CardHolder.BackgroundTransparency = 1
	CardHolder.BorderSizePixel = 0
	CardHolder.Position = UDim2.new(0.23, 0, 0.12, 0)
	CardHolder.Size = UDim2.new(0, 745, 0, 520)
	CardHolder.ScrollBarThickness = 0
	CardHolder.CanvasSize = UDim2.new(0, 0, 0, 0)
	CardHolder.ScrollingDirection = Enum.ScrollingDirection.Y
	
	-- CENTERED GRID LAYOUT
	local CardLayout = Instance.new("UIGridLayout")
	CardLayout.Parent = CardHolder
	CardLayout.SortOrder = Enum.SortOrder.LayoutOrder
	CardLayout.CellPadding = UDim2.new(0, 15, 0, 15)
	CardLayout.CellSize = UDim2.new(0, 350, 0, 420)
	CardLayout.FillDirection = Enum.FillDirection.Horizontal
	CardLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center  -- CENTERED!
	CardLayout.VerticalAlignment = Enum.VerticalAlignment.Top
	CardLayout.StartCorner = Enum.StartCorner.TopLeft
	
	local CardHolderPadding = Instance.new("UIPadding")
	CardHolderPadding.Parent = CardHolder
	CardHolderPadding.PaddingTop = UDim.new(0, 10)
	
	CardLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
		CardHolder.CanvasSize = UDim2.new(0, 0, 0, CardLayout.AbsoluteContentSize.Y + 30)
	end)
	
	self.Gui = Sparestack
	self.Background = Background
	self.SideHolder = SideHolder
	self.CardHolder = CardHolder
	self.SearchBox = Search
	self.Cards = {}
	self.AllCards = {}
	self.SettingsCards = {}
	self.Tabs = {}
	self.Categories = {}
	self.CurrentTab = nil
	self.CategoryOrder = 0
	self.TabOrder = 0
	self.SettingsMode = false
	self.CardLayoutOrder = 0
	self.ConfigData = {}
	self.SavedConfigs = {}
	self.AutoLoadConfig = false
	
	-- Store drag flag reference
	self.SetSliderDragging = function(value)
		isDraggingSlider = value
	end
	
	-- Load configs from file
	self:LoadConfigsFromFile()
	
	-- Settings Button Click - FIXED
	Settings.MouseButton1Click:Connect(function()
		if not self.SettingsMode then
			if #self.SettingsCards == 0 then
				self:CreateSettingsCards()
			end
			self:ShowSettings()
		else
			if self.CurrentTab then
				self:SwitchTab(self.CurrentTab)
			end
		end
	end)
	
	-- Advanced Search functionality
	Search:GetPropertyChangedSignal("Text"):Connect(function()
		self:AdvancedSearch(Search.Text:lower())
	end)
	
	return self
end

-- Advanced Search - Searches across ALL tabs and features
function SpareStackLib:AdvancedSearch(query)
	if self.SettingsMode then return end
	
	if query == "" then
		-- Reset to current tab
		for _, card in pairs(self.AllCards) do
			if card:GetAttribute("Tab") == self.CurrentTab then
				card.Visible = true
				card.LayoutOrder = card:GetAttribute("OriginalOrder")
			else
				card.Visible = false
			end
		end
		return
	end
	
	-- Search across ALL cards and features
	local matchedCards = {}
	
	for _, card in pairs(self.AllCards) do
		local matchScore = 0
		local cardTitle = card:FindFirstChild("CardTitle")
		
		-- Check card title
		if cardTitle and string.find(cardTitle.Text:lower(), query) then
			matchScore = matchScore + 10
		end
		
		-- Check all features inside the card
		local elementsHolder = card:FindFirstChild("ElementsHolder")
		if elementsHolder then
			for _, element in pairs(elementsHolder:GetChildren()) do
				if element:IsA("Frame") then
					local titleLabel = element:FindFirstChild("TitleLabel")
					if titleLabel and string.find(titleLabel.Text:lower(), query) then
						matchScore = matchScore + 5
					end
				end
			end
		end
		
		if matchScore > 0 then
			table.insert(matchedCards, {card = card, score = matchScore})
		end
	end
	
	-- Sort by match score
	table.sort(matchedCards, function(a, b) return a.score > b.score end)
	
	-- Show matched cards, hide others
	for _, card in pairs(self.AllCards) do
		card.Visible = false
	end
	
	for i, match in ipairs(matchedCards) do
		match.card.Visible = true
		match.card.LayoutOrder = i
	end
end

-- Create Settings Cards
function SpareStackLib:CreateSettingsCards()
	local UICard = Instance.new("Frame")
	UICard.Name = "SettingsCard_UI"
	UICard.Parent = self.CardHolder
	UICard.BackgroundTransparency = 1
	UICard.BorderSizePixel = 0
	UICard.Size = UDim2.new(0, 356, 0, 420)
	UICard.Visible = false
	UICard.LayoutOrder = 10000
	UICard:SetAttribute("IsSettings", true)
	
	self:SetupCard(UICard, "UI Settings")
	local UIElements = UICard:FindFirstChild("ElementsHolder")
	
	self:AddToggle(UIElements, "Show FPS", false, function(value)
		print("Show FPS:", value)
	end, false)
	
	self:AddToggle(UIElements, "Show Ping", false, function(value)
		print("Show Ping:", value)
	end, false)
	
	self:AddToggle(UIElements, "Show Watermark", true, function(value)
		print("Show Watermark:", value)
	end, false)
	
	self:AddSlider(UIElements, "UI Scale", 50, 150, 100, function(value)
		local scale = value / 100
		self.Background.Size = UDim2.new(0, 1011 * scale, 0, 630 * scale)
	end)
	
	self:AddButton(UIElements, "Reset UI Position", function()
		self.Background.Position = UDim2.new(0.5, 0, 0.5, 0)
		self:Notify("UI Reset", "Position reset to center", 2)
	end)
	
	table.insert(self.SettingsCards, UICard)
	
	local PerfCard = Instance.new("Frame")
	PerfCard.Name = "SettingsCard_Perf"
	PerfCard.Parent = self.CardHolder
	PerfCard.BackgroundTransparency = 1
	PerfCard.BorderSizePixel = 0
	PerfCard.Size = UDim2.new(0, 356, 0, 420)
	PerfCard.Visible = false
	PerfCard.LayoutOrder = 10001
	PerfCard:SetAttribute("IsSettings", true)
	
	self:SetupCard(PerfCard, "Performance")
	local PerfElements = PerfCard:FindFirstChild("ElementsHolder")
	
	self:AddToggle(PerfElements, "Reduce Graphics", false, function(value)
		print("Reduce Graphics:", value)
	end, false)
	
	self:AddSlider(PerfElements, "Render Distance", 50, 500, 200, function(value)
		print("Render Distance:", value)
	end)
	
	self:AddDropdown(PerfElements, "Quality", {"Low", "Medium", "High", "Ultra"}, "High", function(value)
		print("Quality:", value)
	end)
	
	table.insert(self.SettingsCards, PerfCard)
end

-- Setup Card Visuals
function SpareStackLib:SetupCard(Card, title)
	local CardIcon = Instance.new("ImageLabel")
	CardIcon.Name = "Icon"
	CardIcon.Parent = Card
	CardIcon.BackgroundTransparency = 1
	CardIcon.Position = UDim2.new(0.045, 0, 0.035, 0)
	CardIcon.Size = UDim2.new(0, 20, 0, 20)
	CardIcon.Image = "rbxassetid://97584948400851"
	
	local CardBackground = Instance.new("ImageLabel")
	CardBackground.Name = "Background"
	CardBackground.Parent = Card
	CardBackground.BackgroundTransparency = 1
	CardBackground.Position = UDim2.new(0, 0, 0.119, 0)
	CardBackground.Size = UDim2.new(1, 0, 0.881, 0)
	CardBackground.ZIndex = 0
	CardBackground.Image = "rbxassetid://79172856971491"
	CardBackground.ScaleType = Enum.ScaleType.Stretch
	
	local CardTitleLabel = Instance.new("TextLabel")
	CardTitleLabel.Name = "CardTitle"
	CardTitleLabel.Parent = Card
	CardTitleLabel.BackgroundTransparency = 1
	CardTitleLabel.Position = UDim2.new(0.129, 0, 0, 0)
	CardTitleLabel.Size = UDim2.new(0.87, 0, 0, 50)
	CardTitleLabel.Font = Enum.Font.GothamBold
	CardTitleLabel.Text = title
	CardTitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
	CardTitleLabel.TextSize = 14
	CardTitleLabel.TextXAlignment = Enum.TextXAlignment.Left
	
	local Placard = Instance.new("ImageLabel")
	Placard.Name = "Placard"
	Placard.Parent = Card
	Placard.BackgroundTransparency = 1
	Placard.Size = UDim2.new(1, 0, 0, 50)
	Placard.ZIndex = 0
	Placard.Image = "rbxassetid://91296368223791"
	Placard.ScaleType = Enum.ScaleType.Stretch
	
	local ElementsHolder = Instance.new("ScrollingFrame")
	ElementsHolder.Name = "ElementsHolder"
	ElementsHolder.Parent = Card
	ElementsHolder.BackgroundTransparency = 1
	ElementsHolder.BorderSizePixel = 0
	ElementsHolder.Position = UDim2.new(0.045, 0, 0.135, 0)
	ElementsHolder.Size = UDim2.new(0.91, 0, 0.845, 0)
	ElementsHolder.ScrollBarThickness = 0
	ElementsHolder.CanvasSize = UDim2.new(0, 0, 0, 0)
	ElementsHolder.ScrollingDirection = Enum.ScrollingDirection.Y
	
	local ElementsLayout = Instance.new("UIListLayout")
	ElementsLayout.Parent = ElementsHolder
	ElementsLayout.SortOrder = Enum.SortOrder.LayoutOrder
	ElementsLayout.Padding = UDim.new(0, 10)
	
	ElementsLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
		ElementsHolder.CanvasSize = UDim2.new(0, 0, 0, ElementsLayout.AbsoluteContentSize.Y + 10)
	end)
end

-- Show Settings
function SpareStackLib:ShowSettings()
	self.SettingsMode = true
	
	for _, card in pairs(self.AllCards) do
		card.Visible = false
	end
	
	for _, card in pairs(self.SettingsCards) do
		card.Visible = true
	end
	
	for _, tab in pairs(self.Tabs) do
		tab.Frame.BackgroundTransparency = 1
	end
end

-- Add Category
function SpareStackLib:AddCategory(categoryName)
	self.CategoryOrder = self.CategoryOrder + 1
	
	local CategoryFrame = Instance.new("Frame")
	CategoryFrame.Name = "Category_" .. categoryName
	CategoryFrame.Parent = self.SideHolder
	CategoryFrame.BackgroundTransparency = 1
	CategoryFrame.Size = UDim2.new(0, 200, 0, 31)
	CategoryFrame.LayoutOrder = self.CategoryOrder
	
	local CategoryText = Instance.new("TextLabel")
	CategoryText.Name = "CategoryText"
	CategoryText.Parent = CategoryFrame
	CategoryText.BackgroundTransparency = 1
	CategoryText.Size = UDim2.new(1, 0, 1, 0)
	CategoryText.Font = Enum.Font.GothamBold
	CategoryText.Text = categoryName
	CategoryText.TextColor3 = Color3.fromRGB(58, 58, 73)
	CategoryText.TextSize = 14
	CategoryText.TextXAlignment = Enum.TextXAlignment.Left
	
	self.Categories[categoryName] = {
		Frame = CategoryFrame,
		Tabs = {}
	}
	
	return {
		AddTab = function(_, tabName, tabImage)
			return self:AddTab(tabName, tabImage, categoryName)
		end
	}
end

-- Add Tab
function SpareStackLib:AddTab(tabName, tabImage, categoryName)
	self.TabOrder = self.TabOrder + 1
	
	local Tab = Instance.new("Frame")
	Tab.Name = "Tab_" .. tabName
	Tab.Parent = self.SideHolder
	Tab.BackgroundColor3 = Color3.fromRGB(20, 20, 27)
	Tab.BackgroundTransparency = 1
	Tab.BorderSizePixel = 0
	Tab.Size = UDim2.new(0, 238, 0, 41)
	Tab.LayoutOrder = self.TabOrder
	
	local TabButton = Instance.new("TextButton")
	TabButton.Parent = Tab
	TabButton.BackgroundTransparency = 1
	TabButton.Size = UDim2.new(1, 0, 1, 0)
	TabButton.Text = ""
	TabButton.ZIndex = 2
	
	local TabText = Instance.new("TextLabel")
	TabText.Name = "TabText"
	TabText.Parent = Tab
	TabText.BackgroundTransparency = 1
	TabText.Position = UDim2.new(0.205, 0, 0, 0)
	TabText.Size = UDim2.new(0.795, 0, 1, 0)
	TabText.Font = Enum.Font.GothamBold
	TabText.Text = tabName
	TabText.TextColor3 = Color3.fromRGB(255, 255, 255)
	TabText.TextSize = 14
	TabText.TextXAlignment = Enum.TextXAlignment.Left
	
	local TabImage = Instance.new("ImageLabel")
	TabImage.Name = "TabImage"
	TabImage.Parent = Tab
	TabImage.BackgroundTransparency = 1
	TabImage.Position = UDim2.new(0.08, 0, 0.244, 0)
	TabImage.Size = UDim2.new(0, 20, 0, 20)
	TabImage.Image = tabImage or "rbxassetid://97584948400851"
	
	TabButton.MouseButton1Click:Connect(function()
		self:SwitchTab(tabName)
	end)
	
	self.Tabs[tabName] = {
		Frame = Tab,
		Category = categoryName,
		Cards = {}
	}
	
	if categoryName and self.Categories[categoryName] then
		table.insert(self.Categories[categoryName].Tabs, tabName)
	end
	
	if not self.CurrentTab then
		task.defer(function()
			self:SwitchTab(tabName)
		end)
	end
	
	return tabName
end

-- Switch Tab
function SpareStackLib:SwitchTab(tabName)
	self.CurrentTab = tabName
	self.SettingsMode = false
	self.SearchBox.Text = ""
	
	local tweenInfo = TweenInfo.new(0.25, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
	
	for name, tab in pairs(self.Tabs) do
		if name == tabName then
			TweenService:Create(tab.Frame, tweenInfo, {
				BackgroundTransparency = 0,
				BackgroundColor3 = Color3.fromRGB(20, 20, 27)
			}):Play()
		else
			TweenService:Create(tab.Frame, tweenInfo, {
				BackgroundTransparency = 1
			}):Play()
		end
	end
	
	for _, card in pairs(self.SettingsCards) do
		card.Visible = false
	end
	
	for _, card in pairs(self.AllCards) do
		if card:GetAttribute("Tab") == tabName then
			card.Visible = true
			card.LayoutOrder = card:GetAttribute("OriginalOrder")
		else
			card.Visible = false
		end
	end
end

-- Create Card
function SpareStackLib:CreateCard(cardTitle, tabName, alignment)
	local Card = Instance.new("Frame")
	Card.Name = "Card_" .. cardTitle
	Card.Parent = self.CardHolder
	Card.BackgroundTransparency = 1
	Card.BorderSizePixel = 0
	Card.Size = UDim2.new(0, 356, 0, 420)
	Card:SetAttribute("Tab", tabName)
	Card.Visible = (self.CurrentTab == tabName)
	
	self.CardLayoutOrder = self.CardLayoutOrder + 1
	Card.LayoutOrder = self.CardLayoutOrder
	Card:SetAttribute("OriginalOrder", self.CardLayoutOrder)
	
	self:SetupCard(Card, cardTitle)
	
	local ElementsHolder = Card:FindFirstChild("ElementsHolder")
	
	table.insert(self.Cards, Card)
	table.insert(self.AllCards, Card)
	if self.Tabs[tabName] then
		table.insert(self.Tabs[tabName].Cards, Card)
	end
	
	return {
		Card = Card,
		ElementsHolder = ElementsHolder,
		AddToggle = function(_, name, default, callback, settings)
			return self:AddToggle(ElementsHolder, name, default, callback, settings)
		end,
		AddSlider = function(_, name, min, max, default, callback)
			return self:AddSlider(ElementsHolder, name, min, max, default, callback)
		end,
		AddDropdown = function(_, name, options, default, callback)
			return self:AddDropdown(ElementsHolder, name, options, default, callback)
		end,
		AddButton = function(_, name, callback)
			return self:AddButton(ElementsHolder, name, callback)
		end,
	}
end

-- Add Toggle - MOVED TO RIGHT MORE
function SpareStackLib:AddToggle(parent, name, default, callback, settings)
	callback = callback or function() end
	default = default or false
	settings = settings == nil and false or settings
	
	local Title = Instance.new("Frame")
	Title.Name = "Toggle_" .. name
	Title.Parent = parent
	Title.BackgroundTransparency = 1
	Title.Size = UDim2.new(1, 0, 0, 50)
	
	local TitleLabel = Instance.new("TextLabel")
	TitleLabel.Name = "TitleLabel"
	TitleLabel.Parent = Title
	TitleLabel.BackgroundTransparency = 1
	TitleLabel.Size = UDim2.new(0.55, 0, 1, 0)  -- Reduced from 0.6
	TitleLabel.Font = Enum.Font.GothamBold
	TitleLabel.Text = name
	TitleLabel.TextColor3 = default and Color3.fromRGB(255, 255, 255) or Color3.fromRGB(58, 58, 73)
	TitleLabel.TextSize = 14
	TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
	
	if settings then
		local SettingsIcon = Instance.new("ImageButton")
		SettingsIcon.Name = "SettingsIcon"
		SettingsIcon.Parent = Title
		SettingsIcon.BackgroundTransparency = 1
		SettingsIcon.Position = UDim2.new(0.72, 0, 0.3, 0)  -- Moved right
		SettingsIcon.Size = UDim2.new(0, 15, 0, 15)
		SettingsIcon.Image = "rbxassetid://70543102142774"
		SettingsIcon.ImageColor3 = Color3.fromRGB(46, 46, 66)
		
		SettingsIcon.MouseButton1Click:Connect(function()
			print("Settings clicked for:", name)
		end)
	end
	
	-- TOGGLE MOVED MORE TO THE RIGHT
	local Background_2 = Instance.new("TextButton")
	Background_2.Name = "Background"
	Background_2.Parent = Title
	Background_2.BackgroundColor3 = default and Color3.fromRGB(28, 48, 103) or Color3.fromRGB(21, 21, 28)
	Background_2.BorderSizePixel = 0
	Background_2.Position = UDim2.new(0.85, 0, 0.3, 0)  -- Moved from 0.80 to 0.85
	Background_2.Size = UDim2.new(0, 35, 0, 20)
	Background_2.Text = ""
	
	local BgCorner = Instance.new("UICorner")
	BgCorner.CornerRadius = UDim.new(1, 0)
	BgCorner.Parent = Background_2
	
	local Orb = Instance.new("Frame")
	Orb.Name = "Orb"
	Orb.Parent = Background_2
	Orb.BackgroundColor3 = default and Color3.fromRGB(51, 105, 255) or Color3.fromRGB(37, 37, 57)
	Orb.BorderSizePixel = 0
	Orb.Position = default and UDim2.new(0, 18, 0.15, 0) or UDim2.new(0, 4, 0.15, 0)
	Orb.Size = UDim2.new(0, 13, 0, 13)
	
	local OrbCorner = Instance.new("UICorner")
	OrbCorner.CornerRadius = UDim.new(1, 0)
	OrbCorner.Parent = Orb
	
	local toggled = default
	local tweenInfo = TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out)
	
	local function toggle()
		toggled = not toggled
		
		TweenService:Create(Orb, tweenInfo, {
			Position = toggled and UDim2.new(0, 18, 0.15, 0) or UDim2.new(0, 4, 0.15, 0)
		}):Play()
		
		TweenService:Create(Background_2, tweenInfo, {
			BackgroundColor3 = toggled and Color3.fromRGB(28, 48, 103) or Color3.fromRGB(21, 21, 28)
		}):Play()
		
		TweenService:Create(Orb, tweenInfo, {
			BackgroundColor3 = toggled and Color3.fromRGB(51, 105, 255) or Color3.fromRGB(37, 37, 57)
		}):Play()
		
		TweenService:Create(TitleLabel, tweenInfo, {
			TextColor3 = toggled and Color3.fromRGB(255, 255, 255) or Color3.fromRGB(58, 58, 73)
		}):Play()
		
		pcall(function()
			callback(toggled)
		end)
	end
	
	Background_2.MouseButton1Click:Connect(toggle)
	
	-- Store toggle data for config saving
	local toggleData = {
		Type = "Toggle",
		Name = name,
		Element = Title,
		GetValue = function() return toggled end,
		SetValue = function(value)
			if value ~= toggled then
				toggle()
			end
		end,
		Toggle = toggle
	}
	
	self.ConfigData[name] = toggleData
	
	return toggleData
end

-- Add Slider
function SpareStackLib:AddSlider(parent, name, min, max, default, callback)
	callback = callback or function() end
	min = min or 0
	max = max or 100
	default = math.clamp(default or min, min, max)
	
	local SliderFrame = Instance.new("Frame")
	SliderFrame.Name = "Slider_" .. name
	SliderFrame.Parent = parent
	SliderFrame.BackgroundTransparency = 1
	SliderFrame.Size = UDim2.new(1, 0, 0, 60)
	
	local Title = Instance.new("TextLabel")
	Title.Parent = SliderFrame
	Title.BackgroundTransparency = 1
	Title.Size = UDim2.new(0.5, 0, 0, 25)
	Title.Font = Enum.Font.GothamBold
	Title.Text = name
	Title.TextColor3 = Color3.fromRGB(255, 255, 255)
	Title.TextSize = 14
	Title.TextXAlignment = Enum.TextXAlignment.Left
	
	local ValueLabel = Instance.new("TextBox")
	ValueLabel.Parent = SliderFrame
	ValueLabel.BackgroundTransparency = 1
	ValueLabel.Position = UDim2.new(0.7, 0, 0, 0)
	ValueLabel.Size = UDim2.new(0.3, 0, 0, 25)
	ValueLabel.Font = Enum.Font.Gotham
	ValueLabel.Text = tostring(default)
	ValueLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
	ValueLabel.TextSize = 14
	ValueLabel.TextXAlignment = Enum.TextXAlignment.Right
	
	local Bar = Instance.new("Frame")
	Bar.Name = "Bar"
	Bar.Parent = SliderFrame
	Bar.BackgroundColor3 = Color3.fromRGB(21, 21, 27)
	Bar.BorderSizePixel = 0
	Bar.Position = UDim2.new(0, 0, 0, 35)
	Bar.Size = UDim2.new(0.98, 0, 0, 11)
	
	local BarCorner = Instance.new("UICorner")
	BarCorner.Parent = Bar
	
	local Fill = Instance.new("Frame")
	Fill.Name = "Fill"
	Fill.Parent = Bar
	Fill.BackgroundColor3 = Color3.fromRGB(51, 105, 255)
	Fill.BorderSizePixel = 0
	Fill.Size = UDim2.new(0, 0, 1, 0)
	
	local FillCorner = Instance.new("UICorner")
	FillCorner.Parent = Fill
	
	local Knob = Instance.new("TextButton")
	Knob.Parent = Bar
	Knob.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
	Knob.BorderSizePixel = 0
	Knob.AnchorPoint = Vector2.new(0.5, 0.5)
	Knob.Position = UDim2.new(0, 0, 0.5, 0)
	Knob.Size = UDim2.new(0, 24, 0, 16)
	Knob.ZIndex = 2
	Knob.Text = ""
	
	local KnobCorner = Instance.new("UICorner")
	KnobCorner.CornerRadius = UDim.new(1, 0)
	KnobCorner.Parent = Knob
	
	local dragging = false
	local currentValue = default
	local tweenInfo = TweenInfo.new(0.15, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
	
	local function updateSlider(value)
		value = math.clamp(value, min, max)
		currentValue = math.floor(value)
		
		local percent = (value - min) / (max - min)
		local knobRadius = 12
		local barWidth = Bar.AbsoluteSize.X
		local pixelX = knobRadius + (percent * (barWidth - (knobRadius * 2)))
		
		TweenService:Create(Knob, tweenInfo, {
			Position = UDim2.new(0, pixelX, 0.5, 0)
		}):Play()
		
		TweenService:Create(Fill, tweenInfo, {
			Size = UDim2.new(0, pixelX, 1, 0)
		}):Play()
		
		if max == 100 and min == 0 then
			ValueLabel.Text = currentValue .. "%"
		else
			ValueLabel.Text = tostring(currentValue)
		end
		
		pcall(function()
			callback(currentValue)
		end)
	end
	
	local function updateFromMouse(mouseX)
		local barPos = Bar.AbsolutePosition.X
		local barWidth = Bar.AbsoluteSize.X
		local relativeX = mouseX - barPos
		local percent = math.clamp(relativeX / barWidth, 0, 1)
		local value = min + (percent * (max - min))
		updateSlider(value)
	end
	
	Knob.MouseButton1Down:Connect(function()
		dragging = true
		self.SetSliderDragging(true)
	end)
	
	UIS.InputEnded:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = false
			self.SetSliderDragging(false)
		end
	end)
	
	UIS.InputChanged:Connect(function(input)
		if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
			updateFromMouse(input.Position.X)
		end
	end)
	
	Bar.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			self.SetSliderDragging(true)
			updateFromMouse(input.Position.X)
		end
	end)
	
	Bar.InputEnded:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			self.SetSliderDragging(false)
		end
	end)
	
	ValueLabel.FocusLost:Connect(function()
		local value = tonumber(ValueLabel.Text:match("%d+"))
		if value then
			updateSlider(value)
		else
			updateSlider(currentValue)
		end
	end)
	
	task.spawn(function()
		task.wait(0.1)
		if Bar and Bar.Parent then
			updateSlider(default)
		end
	end)
	
	-- Store slider data for config saving
	local sliderData = {
		Type = "Slider",
		Name = name,
		Min = min,
		Max = max,
		Element = SliderFrame,
		GetValue = function() return currentValue end,
		SetValue = updateSlider
	}
	
	self.ConfigData[name] = sliderData
	
	return sliderData
end

-- Add Dropdown
function SpareStackLib:AddDropdown(parent, name, options, default, callback)
	callback = callback or function() end
	options = options or {"Option 1", "Option 2"}
	default = default or options[1]
	
	local DropdownFrame = Instance.new("Frame")
	DropdownFrame.Name = "Dropdown_" .. name
	DropdownFrame.Parent = parent
	DropdownFrame.BackgroundTransparency = 1
	DropdownFrame.Size = UDim2.new(1, 0, 0, 45)
	DropdownFrame.ClipsDescendants = false
	DropdownFrame.ZIndex = 5
	
	local Dropdown = Instance.new("TextButton")
	Dropdown.Name = "Button"
	Dropdown.Parent = DropdownFrame
	Dropdown.BackgroundColor3 = Color3.fromRGB(20, 20, 27)
	Dropdown.BorderSizePixel = 0
	Dropdown.Size = UDim2.new(1, 0, 0, 36)
	Dropdown.Font = Enum.Font.Gotham
	Dropdown.Text = "  " .. default
	Dropdown.TextColor3 = Color3.fromRGB(255, 255, 255)
	Dropdown.TextSize = 14
	Dropdown.TextXAlignment = Enum.TextXAlignment.Left
	
	local DropdownCorner = Instance.new("UICorner")
	DropdownCorner.CornerRadius = UDim.new(0, 3)
	DropdownCorner.Parent = Dropdown
	
	local DropdownPadding = Instance.new("UIPadding")
	DropdownPadding.Parent = Dropdown
	DropdownPadding.PaddingLeft = UDim.new(0, 10)
	
	local Arrow = Instance.new("ImageLabel")
	Arrow.Name = "Arrow"
	Arrow.Parent = Dropdown
	Arrow.BackgroundTransparency = 1
	Arrow.Position = UDim2.new(0.88, 0, 0.22, 0)
	Arrow.Size = UDim2.new(0, 20, 0, 20)
	Arrow.Image = "rbxassetid://134116754541554"
	
	local OptionsHolder = Instance.new("ScrollingFrame")
	OptionsHolder.Name = "Options"
	OptionsHolder.Parent = DropdownFrame
	OptionsHolder.BackgroundColor3 = Color3.fromRGB(20, 20, 27)
	OptionsHolder.BorderSizePixel = 0
	OptionsHolder.Position = UDim2.new(0, 0, 0, 41)
	OptionsHolder.Size = UDim2.new(1, 0, 0, 0)
	OptionsHolder.Visible = false
	OptionsHolder.ScrollBarThickness = 0
	OptionsHolder.ClipsDescendants = true
	OptionsHolder.ZIndex = 10
	
	local OptionsCorner = Instance.new("UICorner")
	OptionsCorner.CornerRadius = UDim.new(0, 3)
	OptionsCorner.Parent = OptionsHolder
	
	local OptionsList = Instance.new("UIListLayout")
	OptionsList.Parent = OptionsHolder
	OptionsList.SortOrder = Enum.SortOrder.LayoutOrder
	OptionsList.Padding = UDim.new(0, 5)
	
	local OptionsPadding = Instance.new("UIPadding")
	OptionsPadding.Parent = OptionsHolder
	OptionsPadding.PaddingLeft = UDim.new(0, 10)
	OptionsPadding.PaddingRight = UDim.new(0, 10)
	OptionsPadding.PaddingTop = UDim.new(0, 10)
	OptionsPadding.PaddingBottom = UDim.new(0, 10)
	
	local isOpen = false
	local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quint, Enum.EasingDirection.Out)
	local selectedValue = default
	
	for i, optionText in ipairs(options) do
		local Option = Instance.new("TextButton")
		Option.Name = "Option_" .. i
		Option.Parent = OptionsHolder
		Option.BackgroundColor3 = Color3.fromRGB(27, 27, 36)
		Option.BackgroundTransparency = 1
		Option.BorderSizePixel = 0
		Option.Size = UDim2.new(1, -20, 0, 30)
		Option.Font = Enum.Font.Gotham
		Option.Text = "  " .. optionText
		Option.TextColor3 = Color3.fromRGB(255, 255, 255)
		Option.TextSize = 13
		Option.TextXAlignment = Enum.TextXAlignment.Left
		Option.ZIndex = 11
		
		local OptionCorner = Instance.new("UICorner")
		OptionCorner.CornerRadius = UDim.new(0, 3)
		OptionCorner.Parent = Option
		
		local OptionPadding = Instance.new("UIPadding")
		OptionPadding.Parent = Option
		OptionPadding.PaddingLeft = UDim.new(0, 10)
		
		Option.MouseButton1Click:Connect(function()
			Dropdown.Text = "  " .. optionText
			selectedValue = optionText
			pcall(function()
				callback(optionText)
			end)
			
			isOpen = false
			OptionsHolder.Visible = false
			TweenService:Create(OptionsHolder, tweenInfo, {Size = UDim2.new(1, 0, 0, 0)}):Play()
			TweenService:Create(Arrow, tweenInfo, {Rotation = 0}):Play()
		end)
		
		Option.MouseEnter:Connect(function()
			TweenService:Create(Option, TweenInfo.new(0.2), {BackgroundTransparency = 0}):Play()
		end)
		
		Option.MouseLeave:Connect(function()
			TweenService:Create(Option, TweenInfo.new(0.2), {BackgroundTransparency = 1}):Play()
		end)
	end
	
	local dropdownHeight = math.min(#options * 35 + 20, 150)
	
	Dropdown.MouseButton1Click:Connect(function()
		isOpen = not isOpen
		
		if isOpen then
			OptionsHolder.Visible = true
			OptionsHolder.CanvasSize = UDim2.new(0, 0, 0, #options * 35 + 20)
			TweenService:Create(OptionsHolder, tweenInfo, {Size = UDim2.new(1, 0, 0, dropdownHeight)}):Play()
			TweenService:Create(Arrow, tweenInfo, {Rotation = 180}):Play()
		else
			TweenService:Create(OptionsHolder, tweenInfo, {Size = UDim2.new(1, 0, 0, 0)}):Play()
			TweenService:Create(Arrow, tweenInfo, {Rotation = 0}):Play()
			task.wait(0.3)
			if not isOpen then
				OptionsHolder.Visible = false
			end
		end
	end)
	
	-- Store dropdown data for config saving
	local dropdownData = {
		Type = "Dropdown",
		Name = name,
		Options = options,
		Element = DropdownFrame,
		GetValue = function() return selectedValue end,
		SetValue = function(val)
			Dropdown.Text = "  " .. val
			selectedValue = val
		end
	}
	
	self.ConfigData[name] = dropdownData
	
	return dropdownData
end

-- Add Button
function SpareStackLib:AddButton(parent, name, callback)
	callback = callback or function() end
	
	local Button = Instance.new("TextButton")
	Button.Name = "Button_" .. name
	Button.Parent = parent
	Button.BackgroundColor3 = Color3.fromRGB(51, 105, 255)
	Button.BorderSizePixel = 0
	Button.Size = UDim2.new(1, 0, 0, 40)
	Button.Font = Enum.Font.GothamBold
	Button.Text = name
	Button.TextColor3 = Color3.fromRGB(255, 255, 255)
	Button.TextSize = 14
	
	local ButtonCorner = Instance.new("UICorner")
	ButtonCorner.CornerRadius = UDim.new(0, 5)
	ButtonCorner.Parent = Button
	
	Button.MouseButton1Click:Connect(function()
		pcall(function()
			callback()
		end)
		
		TweenService:Create(Button, TweenInfo.new(0.1), {
			BackgroundColor3 = Color3.fromRGB(41, 85, 200)
		}):Play()
		task.wait(0.1)
		TweenService:Create(Button, TweenInfo.new(0.1), {
			BackgroundColor3 = Color3.fromRGB(51, 105, 255)
		}):Play()
	end)
	
	return Button
end

-- IMPROVED CONFIG SYSTEM - CLEAN CARD DESIGN
function SpareStackLib:CreateConfigTab()
	local ConfigCategory = self:AddCategory("CONFIGS")
	local ConfigTab = ConfigCategory:AddTab("Config Manager", "rbxassetid://97584948400851")
	
	-- Config Creation Card
	local CreateCard = self:CreateCard("Create Config", ConfigTab)
	
	-- Config Name Input
	local InputLabel = Instance.new("TextLabel")
	InputLabel.Parent = CreateCard.ElementsHolder
	InputLabel.BackgroundTransparency = 1
	InputLabel.Size = UDim2.new(1, 0, 0, 20)
	InputLabel.Font = Enum.Font.GothamBold
	InputLabel.Text = "Config Name"
	InputLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
	InputLabel.TextSize = 13
	InputLabel.TextXAlignment = Enum.TextXAlignment.Left
	
	local ConfigNameBox = Instance.new("TextBox")
	ConfigNameBox.Parent = CreateCard.ElementsHolder
	ConfigNameBox.BackgroundColor3 = Color3.fromRGB(20, 20, 27)
	ConfigNameBox.BorderSizePixel = 0
	ConfigNameBox.Size = UDim2.new(1, 0, 0, 45)
	ConfigNameBox.Font = Enum.Font.Gotham
	ConfigNameBox.PlaceholderText = "Enter config name..."
	ConfigNameBox.Text = ""
	ConfigNameBox.TextColor3 = Color3.fromRGB(255, 255, 255)
	ConfigNameBox.TextSize = 14
	ConfigNameBox.TextXAlignment = Enum.TextXAlignment.Left
	ConfigNameBox.ClearTextOnFocus = false
	
	local NameBoxCorner = Instance.new("UICorner")
	NameBoxCorner.CornerRadius = UDim.new(0, 5)
	NameBoxCorner.Parent = ConfigNameBox
	
	local NameBoxPadding = Instance.new("UIPadding")
	NameBoxPadding.Parent = ConfigNameBox
	NameBoxPadding.PaddingLeft = UDim.new(0, 12)
	
	-- Save Button
	local SaveButton = Instance.new("TextButton")
	SaveButton.Parent = CreateCard.ElementsHolder
	SaveButton.BackgroundColor3 = Color3.fromRGB(51, 105, 255)
	SaveButton.BorderSizePixel = 0
	SaveButton.Size = UDim2.new(1, 0, 0, 45)
	SaveButton.Font = Enum.Font.GothamBold
	SaveButton.Text = "Save Config"
	SaveButton.TextColor3 = Color3.fromRGB(255, 255, 255)
	SaveButton.TextSize = 14
	
	local SaveCorner = Instance.new("UICorner")
	SaveCorner.CornerRadius = UDim.new(0, 5)
	SaveCorner.Parent = SaveButton
	
	SaveButton.MouseButton1Click:Connect(function()
		local configName = ConfigNameBox.Text:match("^%s*(.-)%s*$")
		if configName == "" then
			self:Notify("Error", "Please enter a config name", 2)
			return
		end
		
		if self.SavedConfigs[configName] then
			self:Notify("Error", "Config already exists", 2)
			return
		end
		
		local configData = {}
		for name, element in pairs(self.ConfigData) do
			configData[name] = {
				Type = element.Type,
				Value = element.GetValue()
			}
		end
		
		self.SavedConfigs[configName] = {
			Name = configName,
			Data = configData,
			Date = os.date("%m.%d.%y")
		}
		
		self:SaveConfigsToFile()
		self:Notify("Success", "Config saved: " .. configName, 2)
		ConfigNameBox.Text = ""
		self:RefreshConfigList()
		
		TweenService:Create(SaveButton, TweenInfo.new(0.1), {
			BackgroundColor3 = Color3.fromRGB(41, 85, 200)
		}):Play()
		task.wait(0.1)
		TweenService:Create(SaveButton, TweenInfo.new(0.1), {
			BackgroundColor3 = Color3.fromRGB(51, 105, 255)
		}):Play()
	end)
	
	SaveButton.MouseEnter:Connect(function()
		TweenService:Create(SaveButton, TweenInfo.new(0.2), {
			BackgroundColor3 = Color3.fromRGB(61, 115, 255)
		}):Play()
	end)
	
	SaveButton.MouseLeave:Connect(function()
		TweenService:Create(SaveButton, TweenInfo.new(0.2), {
			BackgroundColor3 = Color3.fromRGB(51, 105, 255)
		}):Play()
	end)
	
	-- Saved Configs Card
	local ConfigsCard = self:CreateCard("Saved Configs", ConfigTab)
	
	local ConfigListHolder = Instance.new("ScrollingFrame")
	ConfigListHolder.Name = "ConfigList"
	ConfigListHolder.Parent = ConfigsCard.ElementsHolder
	ConfigListHolder.BackgroundTransparency = 1
	ConfigListHolder.BorderSizePixel = 0
	ConfigListHolder.Size = UDim2.new(1, 0, 0, 310)
	ConfigListHolder.ScrollBarThickness = 3
	ConfigListHolder.ScrollBarImageColor3 = Color3.fromRGB(51, 105, 255)
	ConfigListHolder.CanvasSize = UDim2.new(0, 0, 0, 0)
	
	local ConfigListLayout = Instance.new("UIListLayout")
	ConfigListLayout.Parent = ConfigListHolder
	ConfigListLayout.SortOrder = Enum.SortOrder.LayoutOrder
	ConfigListLayout.Padding = UDim.new(0, 10)
	
	ConfigListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
		ConfigListHolder.CanvasSize = UDim2.new(0, 0, 0, ConfigListLayout.AbsoluteContentSize.Y + 10)
	end)
	
	self.ConfigListHolder = ConfigListHolder
	
	return ConfigTab
end

-- RefreshConfigList Function - BETTER DESIGN
function SpareStackLib:RefreshConfigList()
	if not self.ConfigListHolder then return end
	
	-- Clear existing configs
	for _, child in pairs(self.ConfigListHolder:GetChildren()) do
		if child:IsA("Frame") and child:GetAttribute("IsConfig") then
			child:Destroy()
		end
	end
	
	-- Create clean config entries
	for configName, configInfo in pairs(self.SavedConfigs) do
		local ConfigEntry = Instance.new("Frame")
		ConfigEntry.Name = "ConfigEntry_" .. configName
		ConfigEntry.Parent = self.ConfigListHolder
		ConfigEntry.BackgroundColor3 = Color3.fromRGB(25, 25, 32)
		ConfigEntry.BorderSizePixel = 0
		ConfigEntry.Size = UDim2.new(1, 0, 0, 80)
		ConfigEntry:SetAttribute("IsConfig", true)
		
		local EntryCorner = Instance.new("UICorner")
		EntryCorner.CornerRadius = UDim.new(0, 8)
		EntryCorner.Parent = ConfigEntry
		
		-- Config Info Section
		local InfoFrame = Instance.new("Frame")
		InfoFrame.Parent = ConfigEntry
		InfoFrame.BackgroundTransparency = 1
		InfoFrame.Position = UDim2.new(0, 20, 0, 0)
		InfoFrame.Size = UDim2.new(0.45, 0, 1, 0)
		
		local NameLabel = Instance.new("TextLabel")
		NameLabel.Parent = InfoFrame
		NameLabel.BackgroundTransparency = 1
		NameLabel.Position = UDim2.new(0, 0, 0, 15)
		NameLabel.Size = UDim2.new(1, 0, 0, 22)
		NameLabel.Font = Enum.Font.GothamBold
		NameLabel.Text = configInfo.Name
		NameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
		NameLabel.TextSize = 15
		NameLabel.TextXAlignment = Enum.TextXAlignment.Left
		NameLabel.TextTruncate = Enum.TextTruncate.AtEnd
		
		local DateLabel = Instance.new("TextLabel")
		DateLabel.Parent = InfoFrame
		DateLabel.BackgroundTransparency = 1
		DateLabel.Position = UDim2.new(0, 0, 0, 42)
		DateLabel.Size = UDim2.new(1, 0, 0, 18)
		DateLabel.Font = Enum.Font.Gotham
		DateLabel.Text = "Created: " .. configInfo.Date
		DateLabel.TextColor3 = Color3.fromRGB(120, 120, 130)
		DateLabel.TextSize = 12
		DateLabel.TextXAlignment = Enum.TextXAlignment.Left
		
		-- Buttons Section
		local ButtonsFrame = Instance.new("Frame")
		ButtonsFrame.Parent = ConfigEntry
		ButtonsFrame.BackgroundTransparency = 1
		ButtonsFrame.Position = UDim2.new(0.48, 0, 0, 15)
		ButtonsFrame.Size = UDim2.new(0.5, -20, 1, -30)
		
		-- Load Button
		local LoadButton = Instance.new("TextButton")
		LoadButton.Parent = ButtonsFrame
		LoadButton.BackgroundColor3 = Color3.fromRGB(51, 105, 255)
		LoadButton.BorderSizePixel = 0
		LoadButton.Position = UDim2.new(0, 0, 0, 0)
		LoadButton.Size = UDim2.new(0.55, -5, 1, 0)
		LoadButton.Font = Enum.Font.GothamBold
		LoadButton.Text = "Load"
		LoadButton.TextColor3 = Color3.fromRGB(255, 255, 255)
		LoadButton.TextSize = 14
		
		local LoadCorner = Instance.new("UICorner")
		LoadCorner.CornerRadius = UDim.new(0, 6)
		LoadCorner.Parent = LoadButton
		
		-- Delete Button
		local DeleteButton = Instance.new("TextButton")
		DeleteButton.Parent = ButtonsFrame
		DeleteButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
		DeleteButton.BorderSizePixel = 0
		DeleteButton.Position = UDim2.new(0.55, 5, 0, 0)
		DeleteButton.Size = UDim2.new(0.45, -5, 1, 0)
		DeleteButton.Font = Enum.Font.GothamBold
		DeleteButton.Text = "Delete"
		DeleteButton.TextColor3 = Color3.fromRGB(255, 255, 255)
		DeleteButton.TextSize = 14
		
		local DeleteCorner = Instance.new("UICorner")
		DeleteCorner.CornerRadius = UDim.new(0, 6)
		DeleteCorner.Parent = DeleteButton
		
		-- Load Button Click
		LoadButton.MouseButton1Click:Connect(function()
			self:LoadConfig(configName)
			
			TweenService:Create(LoadButton, TweenInfo.new(0.1), {
				BackgroundColor3 = Color3.fromRGB(41, 85, 200)
			}):Play()
			task.wait(0.1)
			TweenService:Create(LoadButton, TweenInfo.new(0.1), {
				BackgroundColor3 = Color3.fromRGB(51, 105, 255)
			}):Play()
		end)
		
		-- Delete Button Click
		DeleteButton.MouseButton1Click:Connect(function()
			self:DeleteConfig(configName)
		end)
		
		-- Hover Effects
		LoadButton.MouseEnter:Connect(function()
			TweenService:Create(LoadButton, TweenInfo.new(0.2), {
				BackgroundColor3 = Color3.fromRGB(61, 115, 255)
			}):Play()
		end)
		
		LoadButton.MouseLeave:Connect(function()
			TweenService:Create(LoadButton, TweenInfo.new(0.2), {
				BackgroundColor3 = Color3.fromRGB(51, 105, 255)
			}):Play()
		end)
		
		DeleteButton.MouseEnter:Connect(function()
			TweenService:Create(DeleteButton, TweenInfo.new(0.2), {
				BackgroundColor3 = Color3.fromRGB(220, 70, 70)
			}):Play()
		end)
		
		DeleteButton.MouseLeave:Connect(function()
			TweenService:Create(DeleteButton, TweenInfo.new(0.2), {
				BackgroundColor3 = Color3.fromRGB(200, 50, 50)
			}):Play()
		end)
		
		-- Entry Hover Effect
		ConfigEntry.MouseEnter:Connect(function()
			TweenService:Create(ConfigEntry, TweenInfo.new(0.2), {
				BackgroundColor3 = Color3.fromRGB(30, 30, 37)
			}):Play()
		end)
		
		ConfigEntry.MouseLeave:Connect(function()
			TweenService:Create(ConfigEntry, TweenInfo.new(0.2), {
				BackgroundColor3 = Color3.fromRGB(25, 25, 32)
			}):Play()
		end)
	end
end

-- Load Configs from File
function SpareStackLib:LoadConfigsFromFile()
	local success, result = pcall(function()
		return readfile("spare_stack_configs.json")
	end)
	
	if success and result then
		local decoded = HttpService:JSONDecode(result)
		self.SavedConfigs = decoded or {}
	else
		self.SavedConfigs = {}
	end
end

-- Save Configs to File
function SpareStackLib:SaveConfigsToFile()
	local success, err = pcall(function()
		local encoded = HttpService:JSONEncode(self.SavedConfigs)
		writefile("spare_stack_configs.json", encoded)
	end)
	
	if not success then
		warn("Failed to save configs:", err)
	end
end

-- LoadConfig Function
function SpareStackLib:LoadConfig(configName)
	local config = self.SavedConfigs[configName]
	if not config then
		self:Notify("Error", "Config not found", 2)
		return
	end
	
	for name, data in pairs(config.Data) do
		if self.ConfigData[name] then
			pcall(function()
				self.ConfigData[name].SetValue(data.Value)
			end)
		end
	end
	
	self:Notify("Success", "Config loaded: " .. configName, 2)
end

function SpareStackLib:DeleteConfig(configName)
	self.SavedConfigs[configName] = nil
	self:SaveConfigsToFile()
	self:Notify("Deleted", "Config deleted: " .. configName, 2)
	self:RefreshConfigList()
end

-- Notify
function SpareStackLib:Notify(title, text, duration)
	duration = duration or 3
	
	local Notification = Instance.new("Frame")
	Notification.Name = "Notification"
	Notification.Parent = self.Gui
	Notification.BackgroundColor3 = Color3.fromRGB(20, 20, 27)
	Notification.BorderSizePixel = 0
	Notification.Position = UDim2.new(0.5, -150, 1, 100)
	Notification.Size = UDim2.new(0, 300, 0, 80)
	Notification.AnchorPoint = Vector2.new(0.5, 1)
	
	local NotifCorner = Instance.new("UICorner")
	NotifCorner.CornerRadius = UDim.new(0, 5)
	NotifCorner.Parent = Notification
	
	local NotifTitle = Instance.new("TextLabel")
	NotifTitle.Parent = Notification
	NotifTitle.BackgroundTransparency = 1
	NotifTitle.Position = UDim2.new(0, 10, 0, 10)
	NotifTitle.Size = UDim2.new(1, -20, 0, 25)
	NotifTitle.Font = Enum.Font.GothamBold
	NotifTitle.Text = title
	NotifTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
	NotifTitle.TextSize = 16
	NotifTitle.TextXAlignment = Enum.TextXAlignment.Left
	
	local NotifText = Instance.new("TextLabel")
	NotifText.Parent = Notification
	NotifText.BackgroundTransparency = 1
	NotifText.Position = UDim2.new(0, 10, 0, 35)
	NotifText.Size = UDim2.new(1, -20, 1, -45)
	NotifText.Font = Enum.Font.Gotham
	NotifText.Text = text
	NotifText.TextColor3 = Color3.fromRGB(200, 200, 200)
	NotifText.TextSize = 14
	NotifText.TextXAlignment = Enum.TextXAlignment.Left
	NotifText.TextYAlignment = Enum.TextYAlignment.Top
	NotifText.TextWrapped = true
	
	TweenService:Create(Notification, TweenInfo.new(0.5), {
		Position = UDim2.new(0.5, -150, 1, -20)
	}):Play()
	
	task.wait(duration)
	
	TweenService:Create(Notification, TweenInfo.new(0.5), {
		Position = UDim2.new(0.5, -150, 1, 100)
	}):Play()
	
	task.wait(0.5)
	Notification:Destroy()
end

return SpareStackLib
